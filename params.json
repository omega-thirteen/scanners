{
  "name": "Scanners",
  "tagline": "A machine-learning project involving EEG recordings",
  "body": "Scanners\r\n======\r\nPredicting motion based on electroencephalographic recordings (EEG).\r\n\r\n## Introduction\r\nThe [electroencephalograph](http://en.wikipedia.org/wiki/Electroencephalography), \r\nor EEG, is a common medical device first developed to diagnose and\r\nmonitor neurological disorders such as epilepsy. To record brain\r\nactivity, up to 128 electrodes are affixed to the patient's scalp at\r\n[standardized points](http://en.wikipedia.org/wiki/10-20_system_\\(EEG\\)). \r\nWhen large numbers of neurons below an electrode fire in unison, the\r\ndifference in electric potential (measured in microvolts) is registered\r\nbetween that electrode and a reference electrode, which is usually\r\nattached to one or both earlobes. The EEG can be administered while the\r\npatient performs simple tasks -- moving arms or legs, observing images\r\non a screen, listening to music -- or even while he or she is asleep.\r\nThe EEG's notable advantages, those being its low cost and minimally\r\ninvasive nature, lend it to applications beyond the hospital setting.\r\nThe nascent field of [brain-computer\r\ninterfaces](http://en.wikipedia.org/wiki/Brain-computer_interface#Non-invasive_BCIs) \r\n(BCI) is one such application.\r\n\r\n## Dataset\r\n[EEG Motor Movement/Imagery Dataset](https://physionet.org/pn4/eegmmidb/), or EEGMMIDB, from [PhysioNet](https://physionet.org):\r\n\r\n>Subjects performed different motor/imagery tasks while 64-channel EEG\r\n>were recorded using the [BCI2000 system](http://www.bci2000.org). Each\r\n>subject performed 14 experimental runs: two one-minute baseline runs\r\n>(one with eyes open, one with eyes closed), and three two-minute runs\r\n>of each of the four following tasks: A target appears on either the\r\n>left or the right side of the screen. The subject opens and closes\r\n>the corresponding fist until the target disappears. Then the subject\r\n>relaxes. A target appears on either the left or the right side of the\r\n>screen. The subject imagines opening and closing the corresponding fist\r\n>until the target disappears. Then the subject relaxes. A target appears\r\n>on either the top or the bottom of the screen. The subject opens and\r\n>closes either both fists (if the target is on top) or both feet (if the\r\n>target is on the bottom) until the target disappears. Then the subject\r\n>relaxes. A target appears on either the top or the bottom of the screen.\r\n>The subject imagines opening and closing either both fists (if the\r\n>target is on top) or both feet (if the target is on the bottom) until\r\n>the target disappears. Then the subject relaxes.\r\n\r\n## Separating wheat from chaff\r\nEasy and cheap to obtain though they may be, EEG recordings do have\r\ninherent drawbacks. For one, the noise-to-signal ratio is uncomfortably\r\nhigh, and artifacts are difficult to avoid: electrical interference,\r\nboth endogenous (heartbeat, eye movement, changes in skin conductivity\r\ndue to sweating) and exogenous (AC power mains), can make interpretation\r\nof recordings difficult or impossible.\r\n\r\nFortunately, these problems can be substantially mitigated with\r\nthe aid of certain mathematical techniques. Low-pass and high-pass\r\n[filters](http://en.wikipedia.org/wiki/Butterworth_filter) were\r\napplied to the raw signal at 30 Hz and 7 Hz, respectively, to\r\nremove high-frequency noise (including that produced by [mains\r\nelectricity](http://en.wikipedia.org/wiki/Mains_electricity) at 60\r\nHz) as well as low-frequency artifacts caused by heartbeat and eye\r\nmovement. Conveniently, the band from 7-30 Hz is likely to carry\r\nall the information we seek: normal, waking neural oscillations\r\nare dominated by [alpha](http://en.wikipedia.org/wiki/Alpha_wave)\r\nand [beta](http://en.wikipedia.org/wiki/Beta_wave) waves. More\r\nto the point, motor activity is typically marked by activity\r\nwithin the [mu band](http://en.wikipedia.org/wiki/Mu_wave),\r\nfrom 7.5-12.5 Hz. While one is at rest, neurons in the [motor\r\ncortex](http://en.wikipedia.org/wiki/Motor_cortex) tend to fire in\r\nunison. At the onset of motion, however, these neurons' activity becomes\r\ndesynchronized, and therein lies the key to successful prediction.\r\n\r\n[Independent component\r\nanalysis](http://en.wikipedia.org/wiki/Independent_component_analysis)\r\n(the [FastICA implementation](http://en.wikipedia.org/wiki/FastICA),\r\nto be specific) was then performed to achieve [signal\r\nseparation](http://en.wikipedia.org/wiki/Blind_signal_separation).\r\nWhy is this necessary? Imagine you have placed three microphones in\r\na room where a lively cocktail party is being held. With multiple\r\nconversations occurring simultaneously, each microphone is bound\r\nto pick up at least some of the sound captured by the other two.\r\nIf one can safely assume that the component signals (the voices\r\nof individual people at the cocktail party) are [statistically\r\nindependent](http://en.wikipedia.org/wiki/Statistical_independence) and\r\nthat the component signals' values are not normally distributed, then\r\nICA can reliably reproduce those signals.\r\n\r\n## Crossing the streams\r\nIn their initial continuous form, EEG recordings are\r\nnot suitable ground on which to build a predictive\r\nalgorithm. The stream must be sectioned into\r\n[epochs](http://en.wikipedia.org/wiki/Quantitative_electroencephalography#Fourier_analysis_of_EEG), \r\ntime-locked series which contain the event of interest.\r\nLike-kind epochs can then be averaged across multiple recordings\r\nand compared between and among experimental subjects. These\r\naverages are known in the literature as [event-related\r\npotentials](http://en.wikipedia.org/wiki/Event-related_potential).\r\n\r\n## Classification procedure\r\nAt this early stage, I have limited the scope of my project to the first\r\nversion of the experiments found in EEGMMIDB, in which each subject was\r\ninstructed to clench the corresponding fist when an image appeared on\r\neither the left or right side of a screen.\r\n\r\nFrom the recordings of 109 subjects who participated in the\r\nexperiment, four sets were removed from the dataset because of\r\nformatting discrepancies. Those remaining were divided into epochs\r\n(200 milliseconds before the event and 500 milliseconds after).\r\nOnly the fourteen electrodes located above the [primary motor\r\ncortex](http://en.wikipedia.org/wiki/Primary_motor_cortex) were used in\r\nthis context.\r\n\r\nAfter packaging the data in a compatible form using\r\n[MNE](http://mne-tools.github.io/stable/index.html) and standardizing\r\neach feature, I divided them into training and testing sets\r\n(80% and 20%, respectively) and then employed scikit-learn's\r\n[SGDClassifier](http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html), \r\nspecifying one of two applicable loss functions, and\r\n[RandomizedSearchCV](http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.RandomizedSearchCV.html) \r\nto tune parameters for the classifier.\r\n\r\nHere are the results produced by SGDClassifier with ['hinge' loss\r\nfunction](http://en.wikipedia.org/wiki/Hinge_loss), which gives a linear\r\nsupport vector machine:\r\n\r\n```\r\nRandomizedSearchCV took 12.69 seconds for 20 candidate parameter settings.\r\nModel with rank: 1\r\nMean validation score: 0.499 (std: 0.002)\r\nParameters: {'n_iter': 9, 'alpha': 17.884975133166026, 'shuffle': True}\r\n\r\nModel with rank: 2\r\nMean validation score: 0.499 (std: 0.002)\r\nParameters: {'n_iter': 10, 'alpha': 0.12765806765435153, 'shuffle': False}\r\n\r\nModel with rank: 3\r\nMean validation score: 0.499 (std: 0.002)\r\nParameters: {'n_iter': 18, 'alpha': 0.1495637472206022, 'shuffle': False}\r\n```\r\n\r\nIt's plain to see that the classifier is performing no better\r\nthan chance (a score of approximately 50%). I suspect this\r\nstems from the format of the input data. MNE provides an\r\n[EpochsVectorizer](http://mne-tools.github.io/stable/generated/mne.decoding.EpochsVectorizer.html) \r\nclass that, as the name suggests, reduces the dimensions of each epoch.\r\nThus far I have not been able to make it work as expected.\r\n\r\n\r\n## Download\r\n```\r\n$ git clone https://github.com/omega-thirteen/scanners.git\r\n```\r\nor, using your SSH key:\r\n```\r\n$ git clone git@github.com:omega-thirteen/scanners.git\r\n```\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}